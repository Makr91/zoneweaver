# Zoneweaver Production Configuration
# This file is installed to /etc/zoneweaver/config.yaml

app:
  name: Zoneweaver
  version: 0.5.3
  frontend_url: https://localhost:3443

mail:
  # Configure SMTP settings for email notifications
  smtp_connect:
    host: localhost
    port: 587
    secure: false
  smtp_auth:
    user: ""
    password: ""
  smtp_settings:
    from: Zoneweaver <noreply@localhost>

server:
  hostname: localhost
  port: 3443
  ssl:
    enabled: true
    generate_ssl: true  # Only applies if existing keys do not exist
    key: /etc/zoneweaver/ssl/key.pem
    cert: /etc/zoneweaver/ssl/cert.pem

frontend:
  port: 3443
  autoRefreshInterval: 5
  enableNotifications: true
  enableDarkMode: true

cors:
  whitelist:
    - https://localhost:3443
    - https://localhost
  options:
    origin: true
    preflightContinue: true
    credentials: true

backend_servers: []

environment:
  trust_proxy: 1

logging:
  level: info
  enabled: true

limits:
  maxServersPerUser: 10

security:
  jwt_secret: "__JWT_SECRET_FROM_FILE__"
  bcrypt_rounds: 10
  sessionTimeout: 24
  allow_new_organizations: true

# Database configuration with UI metadata
database:
  dialect:
    type: select
    value: sqlite
    options: ["sqlite", "mysql", "postgresql", "mariadb"]
    description: "Database type - SQLite for simple deployments, MySQL/PostgreSQL/MariaDB for production"
    required: true
  
  # Connection pooling settings (non-SQLite databases)
  pool:
    max:
      type: integer
      value: 5
      description: "Maximum number of connections in pool"
      required: false
      depends_on: dialect
      show_when: ["mysql", "postgresql", "mariadb"]
    min:
      type: integer
      value: 0
      description: "Minimum number of connections in pool"
      required: false
      depends_on: dialect
      show_when: ["mysql", "postgresql", "mariadb"]
    acquire:
      type: integer
      value: 30000
      description: "Maximum time (ms) to get connection before throwing error"
      required: false
      depends_on: dialect
      show_when: ["mysql", "postgresql", "mariadb"]
    idle:
      type: integer
      value: 10000
      description: "Maximum time (ms) a connection can be idle before being released"
      required: false
      depends_on: dialect
      show_when: ["mysql", "postgresql", "mariadb"]
  
  # SQLite specific settings
  storage:
    type: string
    value: "/var/lib/zoneweaver/database/zoneweaver.db"
    description: "SQLite database file path"
    required: false
    depends_on: dialect
    show_when: sqlite
  
  # Network database settings (MySQL, PostgreSQL, MariaDB)
  host:
    type: host
    value: localhost
    description: "Database host"
    required: false
    depends_on: dialect
    show_when: ["mysql", "postgresql", "mariadb"]
  
  port:
    type: integer
    value: 3306
    description: "Database port (3306 for MySQL/MariaDB, 5432 for PostgreSQL)"
    required: false
    depends_on: dialect
    show_when: ["mysql", "postgresql", "mariadb"]
  
  user:
    type: string
    value: zoneweaver
    description: "Database user"
    required: false
    depends_on: dialect
    show_when: ["mysql", "postgresql", "mariadb"]
  
  password:
    type: password
    value: ""
    description: "Database password"
    required: false
    depends_on: dialect
    show_when: ["mysql", "postgresql", "mariadb"]
  
  database_name:
    type: string
    value: zoneweaver
    description: "Database name"
    required: false
    depends_on: dialect
    show_when: ["mysql", "postgresql", "mariadb"]
  
  # General database settings
  logging:
    type: boolean
    value: false
    description: "Log SQL queries to console (for debugging)"
    required: true

# Session configuration - now uses same database as main app
session:
  table:
    type: string
    value: "sessions"
    description: "Session table name"
    required: true
  secret:
    type: password
    value: "__SESSION_SECRET_FROM_FILE__"
    description: "Session secret key"
    required: true
    readonly: true

# Legacy database path (kept for migration compatibility)
# Remove this after migration is complete
# database:
#   path: /var/lib/zoneweaver/database/zoneweaver.db

gravatar:
  # Get your API key from https://gravatar.com/
  apiKey: ""
